# HomeSchoolBack

#### 介绍
- 利用springboot+shiro+vue+element-ui制作的家校通系统，用户包含家长、教师、管理员。

- 系统共有三类用户，分别是管理员、老师、学生家长；

- 老师使用系统前需要注册，其注册信息管理员审核通过后才能生效；老师在登陆系统后可以创建新的班级并进行班级信息管理，新创建的班级信在管理员审核通过后才能生效，班级信息一旦通过审核则不能再修改；老师也可以加入已生效的班级；老师加入班级后可以发布班级通知，班级通知对该班级的所有家长及老师可见，通知发布后不可修改但可以删除；同一班级的老师和家长之间也可以通过站内信息进行沟通；老师可以通过多条件查询对班级通知和站内信息进行查询；

- 家长使用系统前需要进行注册；家长登陆后可以申请加入的班级，申请信息在班级创建者审核通过后生效；家长加入班级后可以查看班级通知；通过站内信息与班级老师沟通；家长可以通过多条件查询对班级通知和站内信息进行查询；

- 管理员在登陆系统后可以进行教师信息、班级信息进行审核；管理员可以发布系统通知，系统通知对所有用户可见，通知发布后不可修改但可以删除。

#### 使用技术
后端使用的技术：

- Spring Boot
- MySql8.0
- Shiro安全框架
- Mybatis

前端使用的技术：

- vue
- element-UI
- vue-router
- axios


#### 安装教程

1.  配置mysql，运行homeschool.sql，创建好数据库，同时将resources文件夹下的application.yml中的配置更改为自己的数据库用户名+密码：username:xxx   password:xxx
2.  xxxx
3.  xxxx

#### 使用说明

1.  xxxx
2.  xxxx
3.  xxxx

#### 参与贡献

1.  Fork 本仓库
2.  新建 Feat_xxx 分支
3.  提交代码
4.  新建 Pull Request



#### 主要模块功能及其实现

##### (一) 登录(权限认证)模块

页面只有login页面，后端则有login模块专门负责，以及shiro进行权限控制。在登录时前端会发送几个请求给后台请求数据，先是验证用户名密码，正确后后台用getInfo函数查询当前登录用户的用户名、昵称、权限等信息，前端获取到信息后路由根据权限表动态生成菜单，大部分用户管理或添加功能都在前端通过判断存在token中的role来决定是否允许用户看到以及使用，但真正限制住权限的是后端的shiro框架，每个controller的方法都有权限注解，如@RequiresPermissions("classNotice:list")为查看班级通知列表权限，@RequiresPermissions("classNotice:add")为新增班级通知权限，角色权限可通过超级管理员在权限管理页面进行添加修改，或者在数据库的role-permission-relation表自行添加。未经过登录只能访问登录页、注册页、404页，其他页面均会遭到shiro的拦截(在shiroConfiguration.java中可以设置白名单)。

![image-20211217075932431](https://s2.loli.net/2021/12/17/eGqLrUzAnVXts7u.png)

![image-20211217080146798](https://s2.loli.net/2021/12/17/mvpTeJiXWS9FucP.png)

![image-20211217081032316](https://s2.loli.net/2021/12/17/BWdckN8fQVEs4G9.png)

##### (二)注册模块

页面有家长注册页和教师注册页，后端有user模块(不是只有注册功能)负责。填写用户名后，前端发送get请求向后端查询用户名是否已被使用（发送时会先加密再解密，用以防止中文乱码），密码、手机号码均会在前端验证格式，点击注册后结束此页面。教师注册则需要填写工号，并等待管理员审核通过。教师注册的信息发送到后端，会由后端进行封装成为实体类request格式，包括增加请求时间、请求类型、请求状态，同理创建班级请求也会封装。

![image-20211217080018022](https://s2.loli.net/2021/12/17/4iZ1JAodaOXMnlg.png)

![image-20211217080225098](https://s2.loli.net/2021/12/17/GLDbWsiIJBHOQqA.png)

##### (三)班级模块

页面有我的班级、班级详情、班级管理，对话框包括创建班级、加入班级申请审核、编辑公告，后端则有class模块专门负责。进入我的班级页面，前端会先获取该用户的班级列表，若为空则显示另外一个页面，用户可以搜索班级编码加入班级，在加入前不能点击进入班级详情页，同时加入班级的请求在审核前只能发送一次，且未加入班级前不能退出班级，均在前端进行判断。教师可以创建班级，等待管理员审核后即可，创建班级后，系统会自动将创建者加入班级，此后加入班级均需创建者审核通过即可，删除班级可以在班级详情页进行操作，或者管理员在班级管理页进行操作（所有管理页面均为表格，但包含页数等参数，可以在前端设置每页的显示条数），只有管理员或创建者才能进行，编辑公告、删除班级成员也同理，前端会根据token的role以及userId判断身份以及是否为班级创建者来决定是否展示操作按钮，而后端只限制住家长这个角色无权限操作，教师都可以进行操作（前提是有显示操作按钮）。

![image-20211217080409718](https://s2.loli.net/2021/12/17/4ZjkEtb1XdTJrsI.png)

![image-20211217080503171](https://s2.loli.net/2021/12/17/WaegFKMqBi32G9h.png)

##### (四)班级通知模块

页面有班级通知主页、编辑班级通知、班级通知管理，后端有classSystem模块专门负责。教师均可以在班级详情页点击进入编辑页面，填写时会判断内容是否为空，完成编辑后向后端发送，成功后即可展示，编辑器采用的是wangEditor富文本编辑器，存储时用text类型，实际上的字符串均是html格式，故支持各种形式的文字显示（缩进、改变文字大小、颜色等）。班级通知可以进行多条件查询，包括班级、时间、标题、全文关键词等，其中班级的选项需要先向后端发送请求查询用户的班级，时间的话选项的则为天数，后端会根据天数进行设置查询起始时间start。

![image-20211217080547628](C:\Users\19213\AppData\Roaming\Typora\typora-user-images\image-20211217080547628.png)

![image-20211217080611543](https://s2.loli.net/2021/12/17/wVgjIideYy5F3QX.png)

##### (五)站内消息模块

页面有站内消息、编辑消息页，后端有message模块专门负责。用户进入系统后可以自由使用，但发送消息需要在班级详情页进行操作，发送消息时也可以对接收人进行修改，但必须存在该用户。收到消息后可以进行回信。消息也可以进行多条件查询，若查询不到则会弹窗提示，条件与班级通知类似。

![image-20211217080631068](https://s2.loli.net/2021/12/17/fLXMPBVYnZJ5qho.png)

![image-20211217080703986](https://s2.loli.net/2021/12/17/vSCecXxhdyHTiVB.png)

##### (六)系统消息模块

页面有系统通知列表、编辑系统通知、系统通知管理,后端由systemNotice模块专门负责,所有用户都可以看到系统通知列表,而其他两个页面只有有权限的管理员才能显示。编辑同样使用了富文本编辑器。

##### (七)系统请求模块

页面有班级创建申请管理、账号注册申请管理，后端有request模块专门负责，申请的新增是由classController、userController负责，前端只发送requestForm，由后端进行封装成为request。申请的状态有待审核、已通过、已拒绝，待审核状态下可以进行通过、拒绝、删除操作，审核后前端只展示删除按钮，不允许再次修改状态。

![image-20211217080927332](https://s2.loli.net/2021/12/17/qwdTfu68njbXgkp.png)

